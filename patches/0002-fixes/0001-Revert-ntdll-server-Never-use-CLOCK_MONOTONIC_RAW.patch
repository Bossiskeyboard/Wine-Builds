From a8c529bac34b6ae7df7ad368016de1e66bb7fa1c Mon Sep 17 00:00:00 2001
From: Stelios Tsampas <loathingkernel@gmail.com>
Date: Thu, 8 Jan 2026 12:55:22 +0200
Subject: [PATCH] Revert "ntdll,server: Never use CLOCK_MONOTONIC_RAW"

This reverts commit ac6ea1c6f8c912f637418f244b8819b69c12ae68.
---
 dlls/ntdll/unix/sync.c | 2 +-
 server/request.c       | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/dlls/ntdll/unix/sync.c b/dlls/ntdll/unix/sync.c
index 7b2ea804e2f..f5fd233bdf7 100644
--- a/dlls/ntdll/unix/sync.c
+++ b/dlls/ntdll/unix/sync.c
@@ -97,7 +97,7 @@ static inline ULONGLONG monotonic_counter(void)
     return mach_continuous_time() * timebase.numer / timebase.denom / 100;
 #elif defined(HAVE_CLOCK_GETTIME)
     struct timespec ts;
-#if 0
+#ifdef CLOCK_MONOTONIC_RAW
     if (!clock_gettime( CLOCK_MONOTONIC_RAW, &ts ))
         return ts.tv_sec * (ULONGLONG)TICKSPERSEC + ts.tv_nsec / 100;
 #endif
diff --git a/server/request.c b/server/request.c
index b097ada25ac..b9c23370974 100644
--- a/server/request.c
+++ b/server/request.c
@@ -517,7 +517,7 @@ timeout_t monotonic_counter(void)
     return mach_continuous_time() * timebase.numer / timebase.denom / 100;
 #elif defined(HAVE_CLOCK_GETTIME)
     struct timespec ts;
-#if 0
+#ifdef CLOCK_MONOTONIC_RAW
     if (!clock_gettime( CLOCK_MONOTONIC_RAW, &ts ))
         return (timeout_t)ts.tv_sec * TICKS_PER_SEC + ts.tv_nsec / 100;
 #endif
-- 
2.52.0

